module.exports=function(n){var e={};function t(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return n[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=n,t.c=e,t.d=function(n,e,r){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:r})},t.r=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},t.p="",t.w={},t(t.s=0)}([function(n,e,t){"use strict";var r=t(1),o=t(2),i=t(10),a=t(5);i.info("it is starting");var s=r.createServer(function(n,e){return i.info("Starting Account Link Extension - Version:","1.6.0"),i.info(" > WT_URL:",n("WT_URL")),i.info(" > PUBLIC_WT_URL:",n("PUBLIC_WT_URL")),o(n,e)});n.exports=function(n,e,t){e.x_wt&&e.x_wt.ectx&&e.x_wt.ectx.PUBLIC_WT_URL||!1||a.setValue("PUBLIC_WT_URL",r.urlHelpers.getWebtaskUrl(e)),s(n,e,t)}},function(n,e){n.exports=require("auth0-extension-hapi-tools@1.2.2")},function(n,e,t){"use strict";(function(e){var r=t(3),o=t(4),i=o.FileStorageContext,a=o.WebtaskStorageContext,s=t(5),c=t(6),u=t(10),l=t(129).init,f=function(n){n?(u.error("Hapi initialization failed."),u.error(n),console.log("Hapi initialization failed.")):(u.info("Hapi initialization completed."),console.log("Hapi initialization completed."))};n.exports=function(n,t,o){return s.setProvider(function(e){return n(e)||Object({NODE_ENV:"production",CLIENT_VERSION:"1.6.0"})[e]}),l(t?new a(t,{force:1}):new i(r.join(e,"../data.json"))),c(o||f)}}).call(this,"/")},function(n,e){n.exports=require("path")},function(n,e){n.exports=require("auth0-extension-tools@1.3.1")},function(n,e,t){"use strict";var r=t(4).config;n.exports=r()},function(n,e,t){"use strict";(function(e){var r=t(3),o=t(7),i=t(8),a=t(9),s=t(5),c=t(10),u=t(12),l=t(183),f=t(184);n.exports=function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l,d=new o.Server;return d.connection({host:"localhost",port:s("PORT"),routes:{cors:!0,validate:{},files:{relativeTo:r.join(e,"../public")}}}),d.register([a,i],function(){}),d.route({method:"GET",path:"/js/{file*}",config:{auth:!1},handler:{directory:{path:r.join(e,"../public/js")}}}),d.route({method:"GET",path:"/css/{file*}",config:{auth:!1},handler:{directory:{path:r.join(e,"../public/css")}}}),d.register([f,t,u],function(e){c.debug=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];d.log(["debug"],e.join(" "))},c.info=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];d.log(["info"],e.join(" "))},c.error=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];d.log(["error"],e.join(" "))},e&&n(e),n(null,d)}),d}}).call(this,"/")},function(n,e){n.exports=require("hapi@13.5.0")},function(n,e){n.exports=require("inert@4.0.1")},function(n,e){n.exports=require("hapi-auth-jwt2@7.0.1")},function(n,e,t){"use strict";var r=t(11);r.emitErrs=!0;var o=new r.Logger({transports:[new r.transports.Console({timestamp:!0,level:"debug",handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});n.exports=o},function(n,e){n.exports=require("winston@1.0.0")},function(n,e,t){"use strict";var r=t(13),o=t(158),i=t(161),a=t(162),s=t(164),c=t(169),u=t(171),l=t(172),f=t(173),d=t(178),p=t(180),h=function(n,e){return e.route(n(e))},v=function(n,e,t){h(r,n),h(o,n),h(i,n),h(a,n),h(s,n),h(f,n),h(d,n),h(p,n),h(c,n),h(u,n),h(l,n),t()};v.attributes={name:"routes"},n.exports=v},function(n,e,t){"use strict";var r=t(14)(t(15)),o=t(85).decode,i=t(5),a=(t(86),t(118)),s=t(119),c=t(120),u=t(10),l=t(143),f=t(145),d=t(146),p=t(135).resolveLocale,h=t(137).getSettings,v=t(117);n.exports=function(){return{method:"GET",path:"/",config:{auth:!1},handler:function(n,e){console.log("inside the handler");var t=n.state["account-linking-admin-state"];if(console.log("Linking state",t),void 0!==t&&""!==t)return console.log("Redirecting to adm"),void e.redirect(`${i("PUBLIC_WT_URL")}/admin`).state("account-linking-admin-state","");var m,g=l("production"===i("NODE_ENV")),y=g.tag("link"),b=g.tag(i("CUSTOM_CSS")),x={};n.query.locale&&(x.locale=n.query.locale),n.query.color&&(x.color=`#${n.query.color}`),n.query.title&&(x.title=n.query.title),n.query.logoPath&&(x.logoPath=n.query.logoPath),console.log("req.query.child_token",n.query.child_token),(m=n.query.child_token,new r.default(function(n,e){try{n(o(m))}catch(n){e(n)}})).then(function(t){var r,o,i;(r=t,o=r.sub,i=r.phone_number,a(i).then(function(n){return{currentUser:n.find(function(n){return n.user_id===o}),matchingUsers:n.filter(function(n){return n.user_id!==o})}})).then(function(n){n.currentUser;var r=n.matchingUsers;h().then(function(n){var o=(r[0]&&r[0].user_metadata||{}).locale||n.locale;p(o).then(function(n){var i,a,u=(r.length>0?r[0].identities:[]).map(function(n){return n.provider}).map(f),l=d(u,n("or"));(i=t,a=i.sub,s(a).then(function(n){return console.log("it is here",n),n})).then(function(n){console.log("After search",n),e(c({dynamicSettings:x,stylesheetTag:y,currentUser:n,matchingUsers:r,customCSSTag:b,locale:o,identities:l}))})})})}).catch(function(r){var o=n.query.state;u.error("An error was encountered: ",r),console.log("is this the error is it here?",v.inspect(r,{depth:null})),u.info(`Redirecting to failed link to /continue: ${t.iss}continue?state=${n.query.state}&error=${r}`),e.redirect(`${t.iss}continue?state=${o}&error=${r}&msg=${v.inspect(r,{depth:null})}`)})}).catch(function(n){u.error("An invalid token was provided",n),console.log("An invalid token was provided",n),c({dynamicSettings:x,stylesheetTag:y,currentUser:null,matchingUsers:[],customCSSTag:b}).then(function(n){e(n).code(400)})})}}}},function(n,e){n.exports=function(n){return n&&n.__esModule?n:{default:n}}},function(n,e,t){n.exports=t(16)},function(n,e,t){t(17),t(18),t(62),t(66),t(83),t(84),n.exports=t(26).Promise},function(n,e){},function(n,e,t){"use strict";var r=t(19)(!0);t(22)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n,e=this._t,t=this._i;return t>=e.length?{value:void 0,done:!0}:(n=r(e,t),this._i+=n.length,{value:n,done:!1})})},function(n,e,t){var r=t(20),o=t(21);n.exports=function(n){return function(e,t){var i,a,s=String(o(e)),c=r(t),u=s.length;return c<0||c>=u?n?"":void 0:(i=s.charCodeAt(c))<55296||i>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?n?s.charAt(c):i:n?s.slice(c,c+2):a-56320+(i-55296<<10)+65536}}},function(n,e){var t=Math.ceil,r=Math.floor;n.exports=function(n){return isNaN(n=+n)?0:(n>0?r:t)(n)}},function(n,e){n.exports=function(n){if(void 0==n)throw TypeError("Can't call method on  "+n);return n}},function(n,e,t){"use strict";var r=t(23),o=t(24),i=t(40),a=t(29),s=t(41),c=t(42),u=t(58),l=t(60),f=t(59)("iterator"),d=!([].keys&&"next"in[].keys()),p=function(){return this};n.exports=function(n,e,t,h,v,m,g){c(t,e,h);var y,b,x,w=function(n){if(!d&&n in S)return S[n];switch(n){case"keys":case"values":return function(){return new t(this,n)}}return function(){return new t(this,n)}},_=e+" Iterator",k="values"==v,L=!1,S=n.prototype,T=S[f]||S["@@iterator"]||v&&S[v],j=T||w(v),C=v?k?w("entries"):j:void 0,O="Array"==e&&S.entries||T;if(O&&(x=l(O.call(new n)))!==Object.prototype&&x.next&&(u(x,_,!0),r||"function"==typeof x[f]||a(x,f,p)),k&&T&&"values"!==T.name&&(L=!0,j=function(){return T.call(this)}),r&&!g||!d&&!L&&S[f]||a(S,f,j),s[e]=j,s[_]=p,v)if(y={values:k?j:w("values"),keys:m?j:w("keys"),entries:C},g)for(b in y)b in S||i(S,b,y[b]);else o(o.P+o.F*(d||L),e,y);return y}},function(n,e){n.exports=!0},function(n,e,t){var r=t(25),o=t(26),i=t(27),a=t(29),s=t(39),c=function(n,e,t){var u,l,f,d=n&c.F,p=n&c.G,h=n&c.S,v=n&c.P,m=n&c.B,g=n&c.W,y=p?o:o[e]||(o[e]={}),b=y.prototype,x=p?r:h?r[e]:(r[e]||{}).prototype;for(u in p&&(t=e),t)(l=!d&&x&&void 0!==x[u])&&s(y,u)||(f=l?x[u]:t[u],y[u]=p&&"function"!=typeof x[u]?t[u]:m&&l?i(f,r):g&&x[u]==f?function(n){var e=function(e,t,r){if(this instanceof n){switch(arguments.length){case 0:return new n;case 1:return new n(e);case 2:return new n(e,t)}return new n(e,t,r)}return n.apply(this,arguments)};return e.prototype=n.prototype,e}(f):v&&"function"==typeof f?i(Function.call,f):f,v&&((y.virtual||(y.virtual={}))[u]=f,n&c.R&&b&&!b[u]&&a(b,u,f)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,n.exports=c},function(n,e){var t=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(n,e){var t=n.exports={version:"2.5.5"};"number"==typeof __e&&(__e=t)},function(n,e,t){var r=t(28);n.exports=function(n,e,t){if(r(n),void 0===e)return n;switch(t){case 1:return function(t){return n.call(e,t)};case 2:return function(t,r){return n.call(e,t,r)};case 3:return function(t,r,o){return n.call(e,t,r,o)}}return function(){return n.apply(e,arguments)}}},function(n,e){n.exports=function(n){if("function"!=typeof n)throw TypeError(n+" is not a function!");return n}},function(n,e,t){var r=t(30),o=t(38);n.exports=t(34)?function(n,e,t){return r.f(n,e,o(1,t))}:function(n,e,t){return n[e]=t,n}},function(n,e,t){var r=t(31),o=t(33),i=t(37),a=Object.defineProperty;e.f=t(34)?Object.defineProperty:function(n,e,t){if(r(n),e=i(e,!0),r(t),o)try{return a(n,e,t)}catch(n){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(n[e]=t.value),n}},function(n,e,t){var r=t(32);n.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(n,e){n.exports=function(n){return"object"==typeof n?null!==n:"function"==typeof n}},function(n,e,t){n.exports=!t(34)&&!t(35)(function(){return 7!=Object.defineProperty(t(36)("div"),"a",{get:function(){return 7}}).a})},function(n,e,t){n.exports=!t(35)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(n,e){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n,e,t){var r=t(32),o=t(25).document,i=r(o)&&r(o.createElement);n.exports=function(n){return i?o.createElement(n):{}}},function(n,e,t){var r=t(32);n.exports=function(n,e){if(!r(n))return n;var t,o;if(e&&"function"==typeof(t=n.toString)&&!r(o=t.call(n)))return o;if("function"==typeof(t=n.valueOf)&&!r(o=t.call(n)))return o;if(!e&&"function"==typeof(t=n.toString)&&!r(o=t.call(n)))return o;throw TypeError("Can't convert object to primitive value")}},function(n,e){n.exports=function(n,e){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:e}}},function(n,e){var t={}.hasOwnProperty;n.exports=function(n,e){return t.call(n,e)}},function(n,e,t){n.exports=t(29)},function(n,e){n.exports={}},function(n,e,t){"use strict";var r=t(43),o=t(38),i=t(58),a={};t(29)(a,t(59)("iterator"),function(){return this}),n.exports=function(n,e,t){n.prototype=r(a,{next:o(1,t)}),i(n,e+" Iterator")}},function(n,e,t){var r=t(31),o=t(44),i=t(56),a=t(53)("IE_PROTO"),s=function(){},c=function(){var n,e=t(36)("iframe"),r=i.length;for(e.style.display="none",t(57).appendChild(e),e.src="javascript:",(n=e.contentWindow.document).open(),n.write("<script>document.F=Object<\/script>"),n.close(),c=n.F;r--;)delete c.prototype[i[r]];return c()};n.exports=Object.create||function(n,e){var t;return null!==n?(s.prototype=r(n),t=new s,s.prototype=null,t[a]=n):t=c(),void 0===e?t:o(t,e)}},function(n,e,t){var r=t(30),o=t(31),i=t(45);n.exports=t(34)?Object.defineProperties:function(n,e){o(n);for(var t,a=i(e),s=a.length,c=0;s>c;)r.f(n,t=a[c++],e[t]);return n}},function(n,e,t){var r=t(46),o=t(56);n.exports=Object.keys||function(n){return r(n,o)}},function(n,e,t){var r=t(39),o=t(47),i=t(50)(!1),a=t(53)("IE_PROTO");n.exports=function(n,e){var t,s=o(n),c=0,u=[];for(t in s)t!=a&&r(s,t)&&u.push(t);for(;e.length>c;)r(s,t=e[c++])&&(~i(u,t)||u.push(t));return u}},function(n,e,t){var r=t(48),o=t(21);n.exports=function(n){return r(o(n))}},function(n,e,t){var r=t(49);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return"String"==r(n)?n.split(""):Object(n)}},function(n,e){var t={}.toString;n.exports=function(n){return t.call(n).slice(8,-1)}},function(n,e,t){var r=t(47),o=t(51),i=t(52);n.exports=function(n){return function(e,t,a){var s,c=r(e),u=o(c.length),l=i(a,u);if(n&&t!=t){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((n||l in c)&&c[l]===t)return n||l||0;return!n&&-1}}},function(n,e,t){var r=t(20),o=Math.min;n.exports=function(n){return n>0?o(r(n),9007199254740991):0}},function(n,e,t){var r=t(20),o=Math.max,i=Math.min;n.exports=function(n,e){return(n=r(n))<0?o(n+e,0):i(n,e)}},function(n,e,t){var r=t(54)("keys"),o=t(55);n.exports=function(n){return r[n]||(r[n]=o(n))}},function(n,e,t){var r=t(25),o=r["__core-js_shared__"]||(r["__core-js_shared__"]={});n.exports=function(n){return o[n]||(o[n]={})}},function(n,e){var t=0,r=Math.random();n.exports=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++t+r).toString(36))}},function(n,e){n.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(n,e,t){var r=t(25).document;n.exports=r&&r.documentElement},function(n,e,t){var r=t(30).f,o=t(39),i=t(59)("toStringTag");n.exports=function(n,e,t){n&&!o(n=t?n:n.prototype,i)&&r(n,i,{configurable:!0,value:e})}},function(n,e,t){var r=t(54)("wks"),o=t(55),i=t(25).Symbol,a="function"==typeof i;(n.exports=function(n){return r[n]||(r[n]=a&&i[n]||(a?i:o)("Symbol."+n))}).store=r},function(n,e,t){var r=t(39),o=t(61),i=t(53)("IE_PROTO"),a=Object.prototype;n.exports=Object.getPrototypeOf||function(n){return n=o(n),r(n,i)?n[i]:"function"==typeof n.constructor&&n instanceof n.constructor?n.constructor.prototype:n instanceof Object?a:null}},function(n,e,t){var r=t(21);n.exports=function(n){return Object(r(n))}},function(n,e,t){t(63);for(var r=t(25),o=t(29),i=t(41),a=t(59)("toStringTag"),s="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<s.length;c++){var u=s[c],l=r[u],f=l&&l.prototype;f&&!f[a]&&o(f,a,u),i[u]=i.Array}},function(n,e,t){"use strict";var r=t(64),o=t(65),i=t(41),a=t(47);n.exports=t(22)(Array,"Array",function(n,e){this._t=a(n),this._i=0,this._k=e},function(){var n=this._t,e=this._k,t=this._i++;return!n||t>=n.length?(this._t=void 0,o(1)):o(0,"keys"==e?t:"values"==e?n[t]:[t,n[t]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(n,e){n.exports=function(){}},function(n,e){n.exports=function(n,e){return{value:e,done:!!n}}},function(n,e,t){"use strict";var r,o,i,a,s=t(23),c=t(25),u=t(27),l=t(67),f=t(24),d=t(32),p=t(28),h=t(68),v=t(69),m=t(73),g=t(74).set,y=t(76)(),b=t(77),x=t(78),w=t(79),_=c.TypeError,k=c.process,L=c.Promise,S="process"==l(k),T=function(){},j=o=b.f,C=!!function(){try{var n=L.resolve(1),e=(n.constructor={})[t(59)("species")]=function(n){n(T,T)};return(S||"function"==typeof PromiseRejectionEvent)&&n.then(T)instanceof e}catch(n){}}(),O=function(n){var e;return!(!d(n)||"function"!=typeof(e=n.then))&&e},E=function(n,e){if(!n._n){n._n=!0;var t=n._c;y(function(){for(var r=n._v,o=1==n._s,i=0,a=function(e){var t,i,a,s=o?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{s?(o||(2==n._h&&U(n),n._h=1),!0===s?t=r:(l&&l.enter(),t=s(r),l&&(l.exit(),a=!0)),t===e.promise?u(_("Promise-chain cycle")):(i=O(t))?i.call(t,c,u):c(t)):u(r)}catch(n){l&&!a&&l.exit(),u(n)}};t.length>i;)a(t[i++]);n._c=[],n._n=!1,e&&!n._h&&A(n)})}},A=function(n){g.call(c,function(){var e,t,r,o=n._v,i=P(n);if(i&&(e=x(function(){S?k.emit("unhandledRejection",o,n):(t=c.onunhandledrejection)?t({promise:n,reason:o}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",o)}),n._h=S||P(n)?2:1),n._a=void 0,i&&e.e)throw e.v})},P=function(n){return 1!==n._h&&0===(n._a||n._c).length},U=function(n){g.call(c,function(){var e;S?k.emit("rejectionHandled",n):(e=c.onrejectionhandled)&&e({promise:n,reason:n._v})})},I=function(n){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=n,e._s=2,e._a||(e._a=e._c.slice()),E(e,!0))},$=function(n){var e,t=this;if(!t._d){t._d=!0,t=t._w||t;try{if(t===n)throw _("Promise can't be resolved itself");(e=O(n))?y(function(){var r={_w:t,_d:!1};try{e.call(n,u($,r,1),u(I,r,1))}catch(n){I.call(r,n)}}):(t._v=n,t._s=1,E(t,!1))}catch(n){I.call({_w:t,_d:!1},n)}}};C||(L=function(n){h(this,L,"Promise","_h"),p(n),r.call(this);try{n(u($,this,1),u(I,this,1))}catch(n){I.call(this,n)}},(r=function(n){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=t(80)(L.prototype,{then:function(n,e){var t=j(m(this,L));return t.ok="function"!=typeof n||n,t.fail="function"==typeof e&&e,t.domain=S?k.domain:void 0,this._c.push(t),this._a&&this._a.push(t),this._s&&E(this,!1),t.promise},catch:function(n){return this.then(void 0,n)}}),i=function(){var n=new r;this.promise=n,this.resolve=u($,n,1),this.reject=u(I,n,1)},b.f=j=function(n){return n===L||n===a?new i(n):o(n)}),f(f.G+f.W+f.F*!C,{Promise:L}),t(58)(L,"Promise"),t(81)("Promise"),a=t(26).Promise,f(f.S+f.F*!C,"Promise",{reject:function(n){var e=j(this);return(0,e.reject)(n),e.promise}}),f(f.S+f.F*(s||!C),"Promise",{resolve:function(n){return w(s&&this===a?L:this,n)}}),f(f.S+f.F*!(C&&t(82)(function(n){L.all(n).catch(T)})),"Promise",{all:function(n){var e=this,t=j(e),r=t.resolve,o=t.reject,i=x(function(){var t=[],i=0,a=1;v(n,!1,function(n){var s=i++,c=!1;t.push(void 0),a++,e.resolve(n).then(function(n){c||(c=!0,t[s]=n,--a||r(t))},o)}),--a||r(t)});return i.e&&o(i.v),t.promise},race:function(n){var e=this,t=j(e),r=t.reject,o=x(function(){v(n,!1,function(n){e.resolve(n).then(t.resolve,r)})});return o.e&&r(o.v),t.promise}})},function(n,e,t){var r=t(49),o=t(59)("toStringTag"),i="Arguments"==r(function(){return arguments}());n.exports=function(n){var e,t,a;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(t=function(n,e){try{return n[e]}catch(n){}}(e=Object(n),o))?t:i?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(n,e){n.exports=function(n,e,t,r){if(!(n instanceof e)||void 0!==r&&r in n)throw TypeError(t+": incorrect invocation!");return n}},function(n,e,t){var r=t(27),o=t(70),i=t(71),a=t(31),s=t(51),c=t(72),u={},l={};(e=n.exports=function(n,e,t,f,d){var p,h,v,m,g=d?function(){return n}:c(n),y=r(t,f,e?2:1),b=0;if("function"!=typeof g)throw TypeError(n+" is not iterable!");if(i(g)){for(p=s(n.length);p>b;b++)if((m=e?y(a(h=n[b])[0],h[1]):y(n[b]))===u||m===l)return m}else for(v=g.call(n);!(h=v.next()).done;)if((m=o(v,y,h.value,e))===u||m===l)return m}).BREAK=u,e.RETURN=l},function(n,e,t){var r=t(31);n.exports=function(n,e,t,o){try{return o?e(r(t)[0],t[1]):e(t)}catch(e){var i=n.return;throw void 0!==i&&r(i.call(n)),e}}},function(n,e,t){var r=t(41),o=t(59)("iterator"),i=Array.prototype;n.exports=function(n){return void 0!==n&&(r.Array===n||i[o]===n)}},function(n,e,t){var r=t(67),o=t(59)("iterator"),i=t(41);n.exports=t(26).getIteratorMethod=function(n){if(void 0!=n)return n[o]||n["@@iterator"]||i[r(n)]}},function(n,e,t){var r=t(31),o=t(28),i=t(59)("species");n.exports=function(n,e){var t,a=r(n).constructor;return void 0===a||void 0==(t=r(a)[i])?e:o(t)}},function(n,e,t){var r,o,i,a=t(27),s=t(75),c=t(57),u=t(36),l=t(25),f=l.process,d=l.setImmediate,p=l.clearImmediate,h=l.MessageChannel,v=l.Dispatch,m=0,g={},y=function(){var n=+this;if(g.hasOwnProperty(n)){var e=g[n];delete g[n],e()}},b=function(n){y.call(n.data)};d&&p||(d=function(n){for(var e=[],t=1;arguments.length>t;)e.push(arguments[t++]);return g[++m]=function(){s("function"==typeof n?n:Function(n),e)},r(m),m},p=function(n){delete g[n]},"process"==t(49)(f)?r=function(n){f.nextTick(a(y,n,1))}:v&&v.now?r=function(n){v.now(a(y,n,1))}:h?(i=(o=new h).port2,o.port1.onmessage=b,r=a(i.postMessage,i,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(n){l.postMessage(n+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in u("script")?function(n){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),y.call(n)}}:function(n){setTimeout(a(y,n,1),0)}),n.exports={set:d,clear:p}},function(n,e){n.exports=function(n,e,t){var r=void 0===t;switch(e.length){case 0:return r?n():n.call(t);case 1:return r?n(e[0]):n.call(t,e[0]);case 2:return r?n(e[0],e[1]):n.call(t,e[0],e[1]);case 3:return r?n(e[0],e[1],e[2]):n.call(t,e[0],e[1],e[2]);case 4:return r?n(e[0],e[1],e[2],e[3]):n.call(t,e[0],e[1],e[2],e[3])}return n.apply(t,e)}},function(n,e,t){var r=t(25),o=t(74).set,i=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,c="process"==t(49)(a);n.exports=function(){var n,e,t,u=function(){var r,o;for(c&&(r=a.domain)&&r.exit();n;){o=n.fn,n=n.next;try{o()}catch(r){throw n?t():e=void 0,r}}e=void 0,r&&r.enter()};if(c)t=function(){a.nextTick(u)};else if(!i||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve();t=function(){l.then(u)}}else t=function(){o.call(r,u)};else{var f=!0,d=document.createTextNode("");new i(u).observe(d,{characterData:!0}),t=function(){d.data=f=!f}}return function(r){var o={fn:r,next:void 0};e&&(e.next=o),n||(n=o,t()),e=o}}},function(n,e,t){"use strict";var r=t(28);n.exports.f=function(n){return new function(n){var e,t;this.promise=new n(function(n,r){if(void 0!==e||void 0!==t)throw TypeError("Bad Promise constructor");e=n,t=r}),this.resolve=r(e),this.reject=r(t)}(n)}},function(n,e){n.exports=function(n){try{return{e:!1,v:n()}}catch(n){return{e:!0,v:n}}}},function(n,e,t){var r=t(31),o=t(32),i=t(77);n.exports=function(n,e){if(r(n),o(e)&&e.constructor===n)return e;var t=i.f(n);return(0,t.resolve)(e),t.promise}},function(n,e,t){var r=t(29);n.exports=function(n,e,t){for(var o in e)t&&n[o]?n[o]=e[o]:r(n,o,e[o]);return n}},function(n,e,t){"use strict";var r=t(25),o=t(26),i=t(30),a=t(34),s=t(59)("species");n.exports=function(n){var e="function"==typeof o[n]?o[n]:r[n];a&&e&&!e[s]&&i.f(e,s,{configurable:!0,get:function(){return this}})}},function(n,e,t){var r=t(59)("iterator"),o=!1;try{var i=[7][r]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(n){}n.exports=function(n,e){if(!e&&!o)return!1;var t=!1;try{var i=[7],a=i[r]();a.next=function(){return{done:t=!0}},i[r]=function(){return a},n(i)}catch(n){}return t}},function(n,e,t){"use strict";var r=t(24),o=t(26),i=t(25),a=t(73),s=t(79);r(r.P+r.R,"Promise",{finally:function(n){var e=a(this,o.Promise||i.Promise),t="function"==typeof n;return this.then(t?function(t){return s(e,n()).then(function(){return t})}:n,t?function(t){return s(e,n()).then(function(){throw t})}:n)}})},function(n,e,t){"use strict";var r=t(24),o=t(77),i=t(78);r(r.S,"Promise",{try:function(n){var e=o.f(this),t=i(n);return(t.e?e.reject:e.resolve)(t.v),e.promise}})},function(n,e){n.exports=require("jsonwebtoken@7.1.9")},function(n,e,t){"use strict";var r=t(87);t(10);n.exports=function(n){return r({path:"users-by-email",qs:{email:n}})}},function(n,e,t){"use strict";var r=t(14),o=r(t(88)),i=r(t(113)),a=r(t(15)),s=r(t(115)),c=t(4).managementApi,u=t(116),l=t(5),f=t(10),d=t(117),p={base:void 0,getBaseUrl(){return this.base||(this.base=`https://${l("AUTH0_DOMAIN")}/api/v2`),this.base},endpoint(n){return`${this.getBaseUrl()}/${n}`}};n.exports=function(){var n,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.path,r=(0,s.default)(e,["path"]);return(n=c.getAccessTokenCached(l("AUTH0_DOMAIN"),l("AUTH0_CLIENT_ID"),l("AUTH0_CLIENT_SECRET")),console.log("OTP Verification - lib/api/api.js","accessTokenCached",n),n).then(function(n){return new a.default(function(e,a){f.info("CUSTOM EXTENSION - The token is "+n),console.log("CUSTOM EXTENSION - The token is "+n),console.log("options",(0,i.default)(r)),console.log("path",t),u((0,o.default)({url:p.endpoint(t),headers:{Authorization:`Bearer ${n}`,Accept:"application/json"},json:!0},r),function(n,t,r){n?(f.error("error is "+n),console.error("error is "+n),a(n)):t.statusCode<200||t.statusCode>=300?(f.error("API call failed: ",t.statusCode,r),console.error("API call failed: ",t.statusCode,r),a(new Error(r))):(f.info("The response is "+t.body),console.info("The response is "+t.body),console.info("The response is "+t),console.info("The response is "+d.inspect(t.body,{depth:null})),e(t.body))})})}).catch(function(n){console.error("OTP Verification - lib/api/api.js",n)})}},function(n,e,t){var r=t(89),o=t(95),i=t(106),a=t(109);n.exports=function(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{},s=i(t);"function"==typeof o&&(s=s.concat(o(t).filter(function(n){return r(t,n).enumerable}))),s.forEach(function(e){a(n,e,t[e])})}return n}},function(n,e,t){n.exports=t(90)},function(n,e,t){t(91);var r=t(26).Object;n.exports=function(n,e){return r.getOwnPropertyDescriptor(n,e)}},function(n,e,t){var r=t(47),o=t(92).f;t(94)("getOwnPropertyDescriptor",function(){return function(n,e){return o(r(n),e)}})},function(n,e,t){var r=t(93),o=t(38),i=t(47),a=t(37),s=t(39),c=t(33),u=Object.getOwnPropertyDescriptor;e.f=t(34)?u:function(n,e){if(n=i(n),e=a(e,!0),c)try{return u(n,e)}catch(n){}if(s(n,e))return o(!r.f.call(n,e),n[e])}},function(n,e){e.f={}.propertyIsEnumerable},function(n,e,t){var r=t(24),o=t(26),i=t(35);n.exports=function(n,e){var t=(o.Object||{})[n]||Object[n],a={};a[n]=e(t),r(r.S+r.F*i(function(){t(1)}),"Object",a)}},function(n,e,t){n.exports=t(96)},function(n,e,t){t(97),n.exports=t(26).Object.getOwnPropertySymbols},function(n,e,t){"use strict";var r=t(25),o=t(39),i=t(34),a=t(24),s=t(40),c=t(98).KEY,u=t(35),l=t(54),f=t(58),d=t(55),p=t(59),h=t(99),v=t(100),m=t(101),g=t(103),y=t(31),b=t(32),x=t(47),w=t(37),_=t(38),k=t(43),L=t(104),S=t(92),T=t(30),j=t(45),C=S.f,O=T.f,E=L.f,A=r.Symbol,P=r.JSON,U=P&&P.stringify,I=p("_hidden"),$=p("toPrimitive"),N={}.propertyIsEnumerable,q=l("symbol-registry"),R=l("symbols"),M=l("op-symbols"),F=Object.prototype,D="function"==typeof A,B=r.QObject,G=!B||!B.prototype||!B.prototype.findChild,W=i&&u(function(){return 7!=k(O({},"a",{get:function(){return O(this,"a",{value:7}).a}})).a})?function(n,e,t){var r=C(F,e);r&&delete F[e],O(n,e,t),r&&n!==F&&O(F,e,r)}:O,H=function(n){var e=R[n]=k(A.prototype);return e._k=n,e},z=D&&"symbol"==typeof A.iterator?function(n){return"symbol"==typeof n}:function(n){return n instanceof A},V=function(n,e,t){return n===F&&V(M,e,t),y(n),e=w(e,!0),y(t),o(R,e)?(t.enumerable?(o(n,I)&&n[I][e]&&(n[I][e]=!1),t=k(t,{enumerable:_(0,!1)})):(o(n,I)||O(n,I,_(1,{})),n[I][e]=!0),W(n,e,t)):O(n,e,t)},Y=function(n,e){y(n);for(var t,r=m(e=x(e)),o=0,i=r.length;i>o;)V(n,t=r[o++],e[t]);return n},J=function(n){var e=N.call(this,n=w(n,!0));return!(this===F&&o(R,n)&&!o(M,n))&&(!(e||!o(this,n)||!o(R,n)||o(this,I)&&this[I][n])||e)},K=function(n,e){if(n=x(n),e=w(e,!0),n!==F||!o(R,e)||o(M,e)){var t=C(n,e);return!t||!o(R,e)||o(n,I)&&n[I][e]||(t.enumerable=!0),t}},Z=function(n){for(var e,t=E(x(n)),r=[],i=0;t.length>i;)o(R,e=t[i++])||e==I||e==c||r.push(e);return r},X=function(n){for(var e,t=n===F,r=E(t?M:x(n)),i=[],a=0;r.length>a;)!o(R,e=r[a++])||t&&!o(F,e)||i.push(R[e]);return i};D||(s((A=function(){if(this instanceof A)throw TypeError("Symbol is not a constructor!");var n=d(arguments.length>0?arguments[0]:void 0),e=function(t){this===F&&e.call(M,t),o(this,I)&&o(this[I],n)&&(this[I][n]=!1),W(this,n,_(1,t))};return i&&G&&W(F,n,{configurable:!0,set:e}),H(n)}).prototype,"toString",function(){return this._k}),S.f=K,T.f=V,t(105).f=L.f=Z,t(93).f=J,t(102).f=X,i&&!t(23)&&s(F,"propertyIsEnumerable",J,!0),h.f=function(n){return H(p(n))}),a(a.G+a.W+a.F*!D,{Symbol:A});for(var Q="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nn=0;Q.length>nn;)p(Q[nn++]);for(var en=j(p.store),tn=0;en.length>tn;)v(en[tn++]);a(a.S+a.F*!D,"Symbol",{for:function(n){return o(q,n+="")?q[n]:q[n]=A(n)},keyFor:function(n){if(!z(n))throw TypeError(n+" is not a symbol!");for(var e in q)if(q[e]===n)return e},useSetter:function(){G=!0},useSimple:function(){G=!1}}),a(a.S+a.F*!D,"Object",{create:function(n,e){return void 0===e?k(n):Y(k(n),e)},defineProperty:V,defineProperties:Y,getOwnPropertyDescriptor:K,getOwnPropertyNames:Z,getOwnPropertySymbols:X}),P&&a(a.S+a.F*(!D||u(function(){var n=A();return"[null]"!=U([n])||"{}"!=U({a:n})||"{}"!=U(Object(n))})),"JSON",{stringify:function(n){for(var e,t,r=[n],o=1;arguments.length>o;)r.push(arguments[o++]);if(t=e=r[1],(b(e)||void 0!==n)&&!z(n))return g(e)||(e=function(n,e){if("function"==typeof t&&(e=t.call(this,n,e)),!z(e))return e}),r[1]=e,U.apply(P,r)}}),A.prototype[$]||t(29)(A.prototype,$,A.prototype.valueOf),f(A,"Symbol"),f(Math,"Math",!0),f(r.JSON,"JSON",!0)},function(n,e,t){var r=t(55)("meta"),o=t(32),i=t(39),a=t(30).f,s=0,c=Object.isExtensible||function(){return!0},u=!t(35)(function(){return c(Object.preventExtensions({}))}),l=function(n){a(n,r,{value:{i:"O"+ ++s,w:{}}})},f=n.exports={KEY:r,NEED:!1,fastKey:function(n,e){if(!o(n))return"symbol"==typeof n?n:("string"==typeof n?"S":"P")+n;if(!i(n,r)){if(!c(n))return"F";if(!e)return"E";l(n)}return n[r].i},getWeak:function(n,e){if(!i(n,r)){if(!c(n))return!0;if(!e)return!1;l(n)}return n[r].w},onFreeze:function(n){return u&&f.NEED&&c(n)&&!i(n,r)&&l(n),n}}},function(n,e,t){e.f=t(59)},function(n,e,t){var r=t(25),o=t(26),i=t(23),a=t(99),s=t(30).f;n.exports=function(n){var e=o.Symbol||(o.Symbol=i?{}:r.Symbol||{});"_"==n.charAt(0)||n in e||s(e,n,{value:a.f(n)})}},function(n,e,t){var r=t(45),o=t(102),i=t(93);n.exports=function(n){var e=r(n),t=o.f;if(t)for(var a,s=t(n),c=i.f,u=0;s.length>u;)c.call(n,a=s[u++])&&e.push(a);return e}},function(n,e){e.f=Object.getOwnPropertySymbols},function(n,e,t){var r=t(49);n.exports=Array.isArray||function(n){return"Array"==r(n)}},function(n,e,t){var r=t(47),o=t(105).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(n){return a&&"[object Window]"==i.call(n)?function(n){try{return o(n)}catch(n){return a.slice()}}(n):o(r(n))}},function(n,e,t){var r=t(46),o=t(56).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(n){return r(n,o)}},function(n,e,t){n.exports=t(107)},function(n,e,t){t(108),n.exports=t(26).Object.keys},function(n,e,t){var r=t(61),o=t(45);t(94)("keys",function(){return function(n){return o(r(n))}})},function(n,e,t){var r=t(110);n.exports=function(n,e,t){return e in n?r(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}},function(n,e,t){n.exports=t(111)},function(n,e,t){t(112);var r=t(26).Object;n.exports=function(n,e,t){return r.defineProperty(n,e,t)}},function(n,e,t){var r=t(24);r(r.S+r.F*!t(34),"Object",{defineProperty:t(30).f})},function(n,e,t){n.exports=t(114)},function(n,e,t){var r=t(26),o=r.JSON||(r.JSON={stringify:JSON.stringify});n.exports=function(n){return o.stringify.apply(o,arguments)}},function(n,e,t){var r=t(95),o=t(106);n.exports=function(n,e){if(null==n)return{};var t,i,a={},s=o(n);for(i=0;i<s.length;i++)t=s[i],e.indexOf(t)>=0||(a[t]=n[t]);if(r){var c=r(n);for(i=0;i<c.length;i++)t=c[i],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}},function(n,e){n.exports=require("request@2.81.0")},function(n,e){n.exports=require("util")},function(n,e,t){"use strict";var r=t(87);t(10);n.exports=function(n){return r({path:"users",qs:{q:`phone_number:"${n}"`,search_engine:"v3"}})}},function(n,e,t){"use strict";var r=t(87);t(10);n.exports=function(n){return r({path:`users/${n}`})}},function(n,e,t){"use strict";var r=t(14),o=r(t(121)),i=r(t(15)),a=t(128),s=t(129).get,c=t(130),u=t(140),l=t(142),f=/\{\{\s*(.*?)\s*\}\}/g;n.exports=function(n){var e=n.stylesheetTag,t=n.customCSSTag,r=n.currentUser,d=n.matchingUsers,p=n.dynamicSettings,h=n.identities,v=n.locale;return i.default.all([c(p,h,v),s().read()]).then(function(n){var i=(0,o.default)(n,2),s=i[0],c=i[1],p=c.settings?c.settings.template:a;if(console.log("it is inside template promise"),r.user_metadata=r.user_metadata||{},r.user_metadata.mobileNumber=r.user_metadata.mobileNumber||"",""!==r.user_metadata.mobileNumber){var h=l.PhoneNumberUtil.getInstance(),v=l.PhoneNumberFormat,m=h.parseAndKeepRawInput(r.user_metadata.mobileNumber),g=h.format(m,v.NATIONAL).replace(/[\+\ \-\(\)]/gi,"");console.log(`TEST: ${h.getSupportedRegions()}`);var y=h.getRegionCodeForNumber(m);console.log("Number format update "+r.user_metadata.mobileNumber+" to "+g+" country "+y),r.user_metadata.mobileNumber=g,r.user_metadata.mobileNumberCountry=y}return function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n||"string"!=typeof n)throw new Error("Invalid template provided");return n.replace(f,function(n,t){return e[t]||""})}(p,{ExtensionCSS:e,EmbeededCss:"buildExtensionCSS",CustomCSS:t,Auth0Widget:s,ExtensionScripts:u(r,d)})})}},function(n,e,t){var r=t(122),o=t(123),i=t(127);n.exports=function(n,e){return r(n)||o(n,e)||i()}},function(n,e){n.exports=function(n){if(Array.isArray(n))return n}},function(n,e,t){var r=t(124);n.exports=function(n,e){var t=[],o=!0,i=!1,a=void 0;try{for(var s,c=r(n);!(o=(s=c.next()).done)&&(t.push(s.value),!e||t.length!==e);o=!0);}catch(n){i=!0,a=n}finally{try{o||null==c.return||c.return()}finally{if(i)throw a}}return t}},function(n,e,t){n.exports=t(125)},function(n,e,t){t(62),t(18),n.exports=t(126)},function(n,e,t){var r=t(31),o=t(72);n.exports=t(26).getIterator=function(n){var e=o(n);if("function"!=typeof e)throw TypeError(n+" is not iterable!");return r(e.call(n))}},function(n,e){n.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(n,e,t){"use strict";n.exports='\n<!doctype html>\n<html class="auth0-lock-html">\n  <head>\n    <meta charset="utf-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">\n    <meta name="author" content="Auth0">\n    <meta name="description" content="Easily link two accounts into one">\n    <title>Auth0 OTP Extension</title>\n    <link rel="shortcut icon" href="https://auth0.com/auth0-styleguide/img/favicon.png" />\n    {{ ExtensionCSS }}\n    {{ CustomCSS }}\n  </head>\n  <body>\n    {{ Auth0Widget }}\n    {{ ExtensionScripts }}\n  </body>\n</html>\n'},function(n,e,t){"use strict";var r=null;n.exports.init=function(n){r=n},n.exports.get=function(){if(!r)throw new Error("The DB has not been initialized.");return r}},function(n,e,t){"use strict";var r=t(14)(t(131)),o=t(135).resolveLocale,i=t(137).getSettings,a=t(138),s=t(139),c=t(139).lockOutlineClass;new RegExp(/\{\{(\s+)?identities(\s+)?\}\}/);n.exports=function(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en";return i().then(function(e){var i=(0,r.default)(e,n);return o(t).then(function(n){return`\n            <div id="auth0-lock-container-1" class="auth0-lock-container">\n                <div class="auth0-lock auth0-lock-opened auth0-lock-with-tabs ${c(i.removeOverlay)}">\n                    ${s(i.removeOverlay)}\n                    <div class="auth0-lock-center">\n                        <form class="auth0-lock-widget">\n                        <div class="auth0-lock-widget-container">\n                            <div class="auth0-lock-cred-pane auth0-lock-quiet">\n                            <div class="auth0-lock-header">\n                                <div class="auth0-lock-header-bg auth0-lock-blur-support">\n                                <div class="auth0-lock-header-bg-blur"></div>\n                                <div class="auth0-lock-header-bg-solid"></div>\n                                </div>\n                                <div class="auth0-lock-header-welcome">\n                                  ${function(n){return""!==n.logoPath?`<img src='${n.logoPath}' class="auth0-lock-header-logo" />`:`\n    <svg class="auth0-lock-header-logo" width="52.47px" height="58px" viewBox="0 0 151 172">\n        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <g id="logo-grey-horizontal">\n                <g id="Group">\n                <g id="LogoBadge" fill-opacity="1" fill="rgb(234, 83, 35)">\n                    <path d="${a.badge}" id="Shape"></path>\n                </g>\n                </g>\n            </g>\n        </g>\n    </svg>`}(i)}\n                                  <div class="auth0-lock-name">${function(n,e){return""!==n.title?n.title:e("accountLinking")}(i,n)}</div>\n                                </div>\n                            </div>\n                            <div id="error-message" class="auth0-global-message auth0-global-message-error"></div>\n                            <div style="position: relative;">\n                                <span>\n                                <div class="">\n                                    <div style="visibility: inherit;">\n                                    <div class="auth0-lock-view-content">\n                                        <div style="position: relative;">\n                                        <div class="auth0-lock-body-content">\n                                            <div class="auth0-lock-content">\n                                            <div class="auth0-lock-form" id="content-container">\n                                                <div>\n                                                <p id="message">\n                                                    ${n("introduction")}.\n                                                </p>\n                                                <p class="auth0-lock-alternative">\n                                                    <a class="auth0-lock-alternative-link" id="skip" href="#">\n                                                    ${n("skipAlternativeLink")}\n                                                    </a>\n                                                </p>\n                                                </div>\n                                            </div>\n                                            </div>\n                                        </div>\n                                        </div>\n                                    </div>\n                                    </div>\n                                </div>\n                                </span>\n                            </div>\n                            <div class="auth0-lock-actions">\n                                ${function(n,e){var t="";return""!==n.color&&(t=`style="background-color: ${n.color}"`),`\n    <button class="auth0-lock-submit" ${t} type="button" id="link">\n      <span class="auth0-label-submit">\n        <span id="label-value">${e("continue")}</span>\n        <span>\n          <svg class="icon-text" width="8px" height="12px" viewBox="0 0 8 12" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="Symbols" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Web/Submit/Active" transform="translate(-148.000000, -32.000000)" fill="#FFFFFF"><polygon id="Shape" points="148 33.4 149.4 32 155.4 38 149.4 44 148 42.6 152.6 38"></polygon></g></g></svg>\n        </span>\n      </span>\n    </button>`}(i,n)}\n                            </div>\n                            </div>\n                        </div>\n                        </form>\n                    </div>\n                </div>\n            </div>\n            <script>\n                window.Auth0AccountLinkingExtension = window.Auth0AccountLinkingExtension || {};\n                window.Auth0AccountLinkingExtension.locale = {\n                    pageMismatchError: '${n("pageMismatchError")}',\n                    sameEmailAddressError: '${n("sameEmailAddressError")}'\n                }\n            <\/script>\n         \n            `})})}},function(n,e,t){n.exports=t(132)},function(n,e,t){t(133),n.exports=t(26).Object.assign},function(n,e,t){var r=t(24);r(r.S+r.F,"Object",{assign:t(134)})},function(n,e,t){"use strict";var r=t(45),o=t(102),i=t(93),a=t(61),s=t(48),c=Object.assign;n.exports=!c||t(35)(function(){var n={},e={},t=Symbol(),r="abcdefghijklmnopqrst";return n[t]=7,r.split("").forEach(function(n){e[n]=n}),7!=c({},n)[t]||Object.keys(c({},e)).join("")!=r})?function(n,e){for(var t=a(n),c=arguments.length,u=1,l=o.f,f=i.f;c>u;)for(var d,p=s(arguments[u++]),h=l?r(p).concat(l(p)):r(p),v=h.length,m=0;v>m;)f.call(p,d=h[m++])&&(t[d]=p[d]);return t}:c},function(n,e,t){"use strict";var r=t(14)(t(15)),o=t(136),i=t(137).getLocales,a=o,s="(MISSING_LOCALE)";n.exports={allLocales:a,resolveLocale:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",e=arguments.length>1?arguments[1]:void 0;return("object"==typeof e?r.default.resolve(e):i()).then(function(e){return function(t){return e[n][t]||e.en[t]||a[n][t]||s}}).catch(function(){return a})}}},function(n){n.exports={en:{_name:"English",pageMismatchError:"You seem to have reached this page in error. Please try logging in again",continue:"Continue",accountLinking:"OTP Verification",introduction:"We would like to verify if your phone number matches our internal systems. We will send you one sms code to verify it.",skipAlternativeLink:"I want to skip this verification. (You won't be able to access our systems)",sameEmailAddressError:"Accounts must have matching email addresses. Please try again.",identities:"You may sign in with {{identities}} to link accounts",or:"or"}}},function(n,e,t){"use strict";var r=t(129).get,o=t(136),i="ok",a={template:t(128),locale:"en",status:i,color:"#eb5424",title:"",logoPath:"",removeOverlay:!1};n.exports={STATUS_SUCCESSFUL:i,STATUS_ERRORED:"error",getSettings:function(){return r().read().then(function(n){return n.settings||a})},setSettings:function(n){return r().write({settings:n}).then(function(){return{status:i}})},getLocales:function(){return r().read().then(function(n){return n.locales||o})},setLocales:function(n){return r().write({locales:n}).then(function(){return{status:i}})}}},function(n,e,t){"use strict";n.exports={text:"M246.517,0.11 C238.439,0.11 231.607,3.916 226.759,11.115 C221.94,18.271 219.393,28.26 219.393,40 C219.393,51.74 221.94,61.729 226.759,68.884 C231.607,76.084 238.439,79.889 246.517,79.889 C254.595,79.889 261.427,76.084 266.275,68.884 C271.093,61.729 273.64,51.74 273.64,40 C273.64,28.26 271.093,18.271 266.275,11.115 C261.427,3.916 254.595,0.11 246.517,0.11 L246.517,0.11 Z M246.517,70.005 C242.655,70.005 239.604,67.82 237.187,63.324 C234.268,57.893 232.66,49.61 232.66,40 C232.66,30.39 234.268,22.106 237.187,16.676 C239.604,12.18 242.655,9.994 246.517,9.994 C250.378,9.994 253.43,12.18 255.847,16.676 C258.766,22.106 260.373,30.389 260.373,40 C260.373,49.611 258.766,57.895 255.847,63.324 C253.43,67.82 250.378,70.005 246.517,70.005 L246.517,70.005 Z M71.45,29.172 L71.45,63.484 C71.45,72.53 78.81,79.889 87.856,79.889 C95.746,79.889 101.707,75.975 103.902,74.291 C104.024,74.197 104.184,74.169 104.331,74.216 C104.478,74.263 104.592,74.379 104.637,74.527 L105.961,78.86 L115.737,78.86 L115.737,29.172 L103.175,29.172 L103.175,66.326 C103.175,66.501 103.076,66.662 102.921,66.743 C100.559,67.961 95.899,70.006 91.231,70.006 C87.252,70.006 84.012,66.768 84.012,62.787 L84.012,29.172 L71.45,29.172 L71.45,29.172 Z M197.237,78.859 L209.8,78.859 L209.8,44.547 C209.8,35.501 202.44,28.141 193.394,28.141 C186.735,28.141 181.393,31.004 178.802,32.71 C178.657,32.805 178.473,32.813 178.322,32.731 C178.171,32.649 178.075,32.491 178.075,32.318 L178.075,1.141 L165.513,1.141 L165.513,78.859 L178.075,78.859 L178.075,41.704 C178.075,41.529 178.174,41.368 178.33,41.288 C180.691,40.069 185.352,38.025 190.019,38.025 C191.947,38.025 193.76,38.776 195.123,40.139 C196.486,41.502 197.236,43.316 197.236,45.243 L197.236,78.859 L197.237,78.859 Z M124.792,39.055 L132.438,39.055 C132.697,39.055 132.907,39.265 132.907,39.524 L132.907,66.858 C132.907,74.043 138.753,79.888 145.938,79.888 C148.543,79.888 151.113,79.512 153.585,78.77 L153.585,69.796 C152.143,69.923 150.485,70.005 149.313,70.005 C147.193,70.005 145.469,68.28 145.469,66.161 L145.469,39.523 C145.469,39.264 145.679,39.054 145.938,39.054 L153.585,39.054 L153.585,29.171 L145.938,29.171 C145.679,29.171 145.469,28.961 145.469,28.702 L145.469,12.295 L132.907,12.295 L132.907,28.702 C132.907,28.961 132.697,29.171 132.438,29.171 L124.792,29.171 L124.792,39.055 L124.792,39.055 Z M51.361,78.859 L64.429,78.859 L44.555,9.55 C42.962,3.992 37.811,0.11 32.029,0.11 C26.247,0.11 21.096,3.992 19.502,9.55 L-0.372,78.859 L12.697,78.859 L18.449,58.798 C18.507,58.597 18.691,58.459 18.9,58.459 L45.158,58.459 C45.367,58.459 45.552,58.597 45.609,58.798 L51.361,78.859 L51.361,78.859 Z M42.056,48.576 L22.004,48.576 C21.857,48.576 21.718,48.507 21.629,48.388 C21.541,48.272 21.513,48.119 21.553,47.978 L31.579,13.012 C31.637,12.811 31.821,12.673 32.03,12.673 C32.239,12.673 32.423,12.811 32.48,13.012 L42.507,47.978 C42.547,48.12 42.519,48.272 42.43,48.388 C42.342,48.507 42.203,48.576 42.056,48.576 L42.056,48.576 Z",badge:"M119.555,135.861 L102.705,83.997 L146.813,51.952 L92.291,51.952 L75.44,0.09 L75.435,0.076 L129.965,0.076 L146.82,51.947 L146.821,51.946 L146.835,51.938 C156.623,82.03 146.542,116.256 119.555,135.861 L119.555,135.861 Z M31.321,135.861 L31.307,135.871 L75.426,167.924 L119.555,135.862 L75.44,103.808 L31.321,135.861 L31.321,135.861 Z M4.052,51.939 L4.052,51.939 C-6.252,83.66 5.709,117.272 31.312,135.867 L31.316,135.851 L48.168,83.99 L4.07,51.951 L58.579,51.951 L75.431,0.089 L75.435,0.075 L20.902,0.075 L4.052,51.939 L4.052,51.939 Z"}},function(n,e,t){"use strict";var r=t(138);n.exports=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"":`\n    <div class="auth0-lock-overlay">\n        <span class="auth0-lock-badge-bottom">\n        <a href="https://auth0.com/?utm_source=lock&amp;utm_campaign=badge&amp;utm_medium=widget" target="_blank" class="auth0-lock-badge">\n            <svg width="58px" height="21px" viewBox="0 0 462 168">\n            <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n                <g id="logo-grey-horizontal">\n                <g id="Group">\n                    <g id="LogoText" transform="translate(188.000000, 41.500000)" fill="#D0D2D3">\n                    <path d="${r.text}" id="Shape"></path>\n                    </g>\n                    <g id="LogoBadge" fill-opacity="0.4" fill="#FFFFFF">\n                    <path d="${r.badge}" id="Shape"></path>\n                    </g>\n                </g>\n                </g>\n            </g>\n            </svg>\n        </a>\n        </span>\n    </div>`},n.exports.lockOutlineClass=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"auth0-lock-outlined":""}},function(n,e,t){"use strict";var r=t(14)(t(113)),o=t(141);n.exports=function(n,e){return`\n<script src="https://unpkg.com/jwt-decode@2.2.0/build/jwt-decode.min.js"><\/script>\n<script src="https://cdnjs.cloudflare.com/ajax/libs/qs/6.5.0/qs.min.js"><\/script>\n<script type="text/javascript">\n  var currentUser = ${(0,r.default)(n)};\n  var matchingUsers = ${(0,r.default)(e)};\n  var bootstrapApp = ${o.toString()};\n\n  bootstrapApp(currentUser, matchingUsers);\n<\/script>\n\n`}},function(n,e,t){"use strict";n.exports=function(n,e){var t,r,o,i=window.Qs.parse(window.location.search,{ignoreQueryPrefix:!0});try{!function(t){console.log("loadLinkPage");var r=document.getElementById("link"),o=document.getElementById("skip"),a=e.reduce(function(n,e){return n.concat(e.identities)},[]).map(function(n){return n.connection}),c={client_id:i.client_id,redirect_uri:i.redirect_uri,response_type:i.response_type,scope:i.scope,state:i.original_state,nonce:i.nonce,audience:i.audience,link_account_token:i.child_token,prevent_sign_up:!0,prompt:"login",login_hint:"sms",login_number:n.user_metadata.mobileNumber,login_number_country:n.user_metadata.mobileNumberCountry};console.log("CONNECTIONS 0",a[0],c),"sms"!==a[0]&&(c.connection=a[0]);r.addEventListener("click",function(n){var e,r,o;console.log("call authorize"),e=t.iss,o=s(r=c).filter(function(n){return!!r[n]}).map(function(n){return n+"="+encodeURIComponent(r[n])}).join("&"),console.log("This is inside the log in - backend or not",e,o),window.location=e+"authorize?"+o}),function(n,e,t){n.href=e+"continue?state="+t}(o,t.iss,i.state),"accountMismatch"===i.error_type&&(u=document.getElementById("error-message"),l=window.Auth0AccountLinkingExtension.locale.sameEmailAddressError||"Accounts must have matching email addresses. Please try again.",u.innerHTML=l,u.style.display="block");var u,l}(window.jwt_decode(i.child_token))}catch(n){console.log("loadLinkPage failed"),console.log(i),console.error(n),t=document.getElementById("content-container"),document.getElementById("label-value"),r=document.getElementById("link"),t.innerHTML="",t.appendChild(a("div",{},[a("p",{},[(o=window.Auth0AccountLinkingExtension.locale.pageMismatchError||"You seem to have reached this page in error. Please try logging in again",document.createTextNode(o))])])),r.disabled=!0}function a(n,e,t){var r,o=document.createElement(n),i=t||[],a=e||{};for(r in s(a))o.setAttribute(r,a[r]);for(r in i)o.appendChild(i[r]);return o}function s(n){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e}}},function(n,e){n.exports=require("google-libphonenumber@2.0.7")},function(n,e,t){"use strict";var r=`https://cdn.auth0.com/extensions/auth0-account-link-extension/${t(144).version}`;n.exports=function(){var n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=n?"min.css":"css",t=function(t){var o=(t||"").trim();return o?`${function(n){return n?r:"/css"}(n)}/${o}.${e}`:""};return{link:t,tag:function(n){var e=t(n);return e?`<link rel="stylesheet" href="${e}">`:""}}}},function(n){n.exports={name:"auth0-otp-verification-extension",version:"1.6.0",description:"Auth0 OTP Verification",main:"index.js",engines:{node:">=6.9"},scripts:{start:"node ./index.js",test:"nyc --all mocha test --recursive --timeout 5000","test:integration":"mocha integration --recursive --timeout 50000",lint:"eslint .","serve:dev":"gulp run","client:build":"minify --clean public/css/link.css && minify --clean public/css/admin.css","extension:build":"a0-ext build:server ./webtask.js ./dist && cp ./dist/auth0-otp-verification-extension.extension.$npm_package_version.js ./build/bundle.js","extension:build:windows":"a0-ext build:server ./webtask.js ./dist && ncp ./dist/auth0-otp-verification-extension.extension.%npm_package_version%.js ./build/bundle.js",build:"yarn run client:build && yarn run extension:build","build:windows":"yarn run client:build && yarn run extension:build:windows"},author:"nelson.matias",license:"MIT","auth0-extension":{nodeTarget:"4.2.0",bundleModules:!0,useHashName:!1,externals:["auth0-extension-hapi-tools@1.2.2","auth0-extension-tools@1.3.1","auth0@2.8.0","bluebird@3.5.0","body-parser@1.12.4","boom@3.2.2","compression@1.4.4","debug@2.2.0","delegates@0.1.0","depd@1.0.1","destroy@1.0.3","ejs@2.3.1","express-jwt@3.1.0","express@4.12.4","hapi-auth-jwt2@7.0.1","hapi@13.5.0","hoek@4.1.0","iconv-lite@0.4.10","inert@4.0.1","jade@1.10.0","joi@9.0.4","jsonwebtoken@7.1.9","jwks-rsa@1.1.1","lodash@3.10.1","lru-cache@2.6.4","lru-memoizer@1.10.0","mime-db@1.10.0","mime-types@2.0.12","moment@2.10.3","morgan@1.5.3","ms@0.7.1","nconf@0.8.4","node-uuid@1.4.3","open@0.0.5","qs@3.1.0","raw-body@2.1.0","read-all-stream@2.1.2","request@2.81.0","superagent@1.2.0","type-check@0.3.1","webtask-tools","winston@1.0.0","google-libphonenumber@2.0.7","xml2js@0.4.8"]},dependencies:{auth0:"^2.8.0","auth0-extension-hapi-tools":"1.2.2","auth0-extension-tools":"1.3.1",boom:"3.2.2",ci:"^1.0.0",hapi:"13.5.0","hapi-auth-jwt2":"7.0.1",inert:"4.0.1",joi:"9.0.4",jsonwebtoken:"^8.1.0","jwks-rsa":"1.1.1",nconf:"^0.8.4",open:"^0.0.5",request:"^2.81.0","webtask-tools":"^3.4.1",winston:"1.0.0"},devDependencies:{"@babel/runtime":"7.0.0-beta.46","auth0-extensions-cli":"^1.1.2",chai:"^4.1.0",eslint:"^4.3.0","eslint-config-auth0":"^11.0.0","eslint-config-auth0-base":"^13.0.0","eslint-plugin-import":"^2.7.0","eslint-plugin-jsx-a11y":"^6.0.2","eslint-plugin-react":"^7.1.0",gulp:"^3.9.1","gulp-nodemon":"^2.2.1","gulp-util":"^3.0.8",minifier:"^0.8.1",mocha:"^3.5.0",ncp:"^2.0.0",ngrok:"^2.3.0",nodemon:"^1.11.0",nyc:"^11.1.0",puppeteer:"^0.11.0",yarn:"^1.19.1"}}},function(n,e,t){"use strict";var r={auth0:"Auth0","google-oauth2":"Google",facebook:"Facebook",windowslive:"Microsoft",linkedin:"LinkedIn",github:"GitHub",dropbox:"Dropbox",bitbucket:"Bitbucket",paypal:"PayPal","paypal-sandbox":"PayPal (Sandbox)",twitter:"Twitter",amazon:"Amazon",vkontakte:"VK",yandex:"Yandex",yahoo:"Yahoo!",thirtysevensignals:"37signals",box:"Box.com",salesforce:"SalesForce","salesforce-sandbox":"SalesForce (Sandbox)","salesforce-community":"SalesForce Community",fitbit:"Fitbit",baidu:"Baidu",renren:"Renren",weibo:"Weibo",aol:"AOL",shopify:"Shopify",wordpress:"WordPress",dwolla:"Dwolla",miicard:"MiiCard",yammer:"Yammer",soundcloud:"SoundCloud",instagram:"Instagram",thecity:"The City","thecity-sandbox":"The City (Sandbox)","planning-center":"Planning Center",evernote:"Evernote","evernote-sandbox":"Evernote (Sandbox)",exact:"Exact.com",daccount:"NTT Docomo",sms:"SMS Code",email:"E-mail Code"};n.exports=function(n){var e=r[n];return void 0!==e?e:n}},function(n,e,t){"use strict";var r=t(14)(t(147));n.exports=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"and",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=n?(0,r.default)(n):[];if(n.length<=1)return o.join("");if(2===n.length)return n.join(` ${e} `);var i=o.pop();return`${o.join(", ")}${t} ${e} ${i}`}},function(n,e,t){var r=t(148),o=t(149),i=t(157);n.exports=function(n){return r(n)||o(n)||i()}},function(n,e){n.exports=function(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}},function(n,e,t){var r=t(150),o=t(154);n.exports=function(n){if(o(Object(n))||"[object Arguments]"===Object.prototype.toString.call(n))return r(n)}},function(n,e,t){n.exports=t(151)},function(n,e,t){t(18),t(152),n.exports=t(26).Array.from},function(n,e,t){"use strict";var r=t(27),o=t(24),i=t(61),a=t(70),s=t(71),c=t(51),u=t(153),l=t(72);o(o.S+o.F*!t(82)(function(n){Array.from(n)}),"Array",{from:function(n){var e,t,o,f,d=i(n),p="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,m=void 0!==v,g=0,y=l(d);if(m&&(v=r(v,h>2?arguments[2]:void 0,2)),void 0==y||p==Array&&s(y))for(t=new p(e=c(d.length));e>g;g++)u(t,g,m?v(d[g],g):d[g]);else for(f=y.call(d),t=new p;!(o=f.next()).done;g++)u(t,g,m?a(f,v,[o.value,g],!0):o.value);return t.length=g,t}})},function(n,e,t){"use strict";var r=t(30),o=t(38);n.exports=function(n,e,t){e in n?r.f(n,e,o(0,t)):n[e]=t}},function(n,e,t){n.exports=t(155)},function(n,e,t){t(62),t(18),n.exports=t(156)},function(n,e,t){var r=t(67),o=t(59)("iterator"),i=t(41);n.exports=t(26).isIterable=function(n){var e=Object(n);return void 0!==e[o]||"@@iterator"in e||i.hasOwnProperty(r(e))}},function(n,e){n.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},function(n,e,t){"use strict";var r=t(159).install,o=t(5),i=t(10);n.exports=function(n){return{method:"POST",path:"/.extensions/on-install",config:{auth:!1,pre:[n.handlers.validateHookToken("/.extensions/on-install"),n.handlers.managementClient]},handler:function(n,e){i.info("Starting rule installation..."),r(n.pre.auth0.rules,{extensionURL:o("PUBLIC_WT_URL"),clientID:o("AUTH0_CLIENT_ID"),clientSecret:o("AUTH0_CLIENT_SECRET")}).then(function(){return e().code(204)}).then(function(){i.info("Rule successfully installed")}).catch(function(n){throw i.error("Something went wrong, ",n),n}).catch(function(n){return e.error(n)})}}}},function(n,e,t){"use strict";var r=t(14)(t(88)),o=t(160),i="auth0-otp-extension",a=function(n){return function(){var e=function(n){return n.find(function(n){return n.name===i})}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);e&&n.delete({id:e.id})}};n.exports={install:function(n,e){var t={name:i,script:o(e),enabled:!0};return n.getAll().then(function(n,e){return function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find(function(n){return n.name===i});return t?n.update({id:t.id},e):n.create((0,r.default)({stage:"login_success"},e))}}(n,t))},uninstall:function(n){return n.getAll().then(a(n))}}},function(n,e,t){"use strict";n.exports=function(n){var e=n.extensionURL,t=void 0===e?"":e,r=n.username,o=void 0===r?"Unknown":r,i=n.clientID,a=void 0===i?"":i,s=n.clientSecret,c=void 0===s?"":s;return`function (user, context, callback) {\n  /**\n   * This rule has been automatically generated by\n   * ${o} - Auth0 -  at ${(new Date).toISOString()}\n   */\n  var request = require('request@2.56.0');\n  var queryString = require('querystring');\n  var Promise = require('native-or-bluebird@1.2.0');\n  var jwt = require('jsonwebtoken@7.1.9');\n  var CONTINUE_PROTOCOL = 'redirect-callback';\n  var LOG_TAG = '[OTP-VERIFICATION]: ';\n  console.log(LOG_TAG, 'Entered Account Link Rule');\n  // 'query' can be undefined when using '/oauth/token' to log in\n  context.request.query = context.request.query || {};\n  var config = {\n    endpoints: {\n      linking: '${t.replace(/\/$/g,"")}',\n      userApi: auth0.baseUrl + '/users',\n      usersByEmailApi: auth0.baseUrl + '/users'\n    },\n    token: {\n      clientId: '${a}',\n      clientSecret: '${c}',\n      issuer: auth0.domain\n    }\n  };\n\n  createStrategy().then(callbackWithSuccess).catch(callbackWithFailure);\n\n  function createStrategy() {\n\n    if (context.connection === "sms" && !shouldLink()) {\n      return callback(new Error("Login not supported for SMS"));\n    }\n\n    if (shouldLink()) {\n      return linkAccounts();\n    } else if (shouldPrompt()) {\n      return promptUser();\n\n    }\n\n    return continueAuth();\n\n    function shouldLink() {\n      return !!context.request.query.link_account_token;\n    }\n\n    function shouldPrompt() {\n      var should = !insideRedirect() && !redirectingToContinue();\n      return should;\n\n      // Check if we're inside a redirect\n      // in order to avoid a redirect loop\n      // TODO: May no longer be necessary\n      function insideRedirect() {\n        return context.request.query.redirect_uri &&\n          context.request.query.redirect_uri.indexOf(config.endpoints.linking) !== -1;\n      }\n\n      // Check if this is the first login of the user\n      // since merging already active accounts can be a\n      // destructive action\n      function firstLogin() {\n        return context.stats.loginsCount <= 1;\n      }\n\n      // Check if we're coming back from a redirect\n      // in order to avoid a redirect loop. User will\n      // be sent to /continue at this point. We need\n      // to assign them to their primary user if so.\n      function redirectingToContinue() {\n        return context.protocol === CONTINUE_PROTOCOL;\n      }\n    }\n  }\n\n  function verifyToken(token, secret) {\n    return new Promise(function (resolve, reject) {\n      jwt.verify(token, secret, function (err, decoded) {\n        if (err) {\n          return reject(err);\n        }\n\n        return resolve(decoded);\n      });\n    });\n  }\n\n  function linkAccounts() {\n    var secondAccountToken = context.request.query.link_account_token;\n\n    return verifyToken(secondAccountToken, config.token.clientSecret)\n      .then(function (decodedToken) {\n\n        // TODO verification on the backend that phone number matches from original and current account\n\n        var linkUri = config.endpoints.userApi + '/' + decodedToken.sub + '/identities';\n\n        var headers = {\n          Authorization: 'Bearer ' + auth0.accessToken,\n          'Content-Type': 'application/json',\n          'Cache-Control': 'no-cache'\n        };\n\n        var newApp_metadata = decodedToken.app_metadata || {};\n        newApp_metadata.isVerified = true;\n\n        var ManagementClient = require('auth0@2.9.1').ManagementClient;\n        var management = new ManagementClient({\n          domain: auth0.domain,\n          token: auth0.accessToken\n        });\n\n        var userPayload = {\n          app_metadata: newApp_metadata\n        };\n\n        return apiCall({\n          method: 'GET',\n          url: config.endpoints.userApi + '/' + user.user_id + '?fields=identities,user_id',\n          headers: headers\n        })\n          .then(async function (secondaryUser) {\n            var provider = secondaryUser &&\n              secondaryUser.identities &&\n              secondaryUser.identities[0] &&\n              secondaryUser.identities[0].provider;\n\n            // For this case, there is already an identity with username and password  \n            if (provider && provider === "auth0") {\n\n              if (secondaryUser.identities && secondaryUser.identities[1] && secondaryUser.identities[1].provider === "sms") {\n                var unlinkUri = config.endpoints.userApi + "/" + user.user_id + "/identities/sms/" + secondaryUser.identities[1].user_id;\n\n                var smsUserId = "sms|"+secondaryUser.identities[1].user_id;\n               \n                await apiCall({\n                  method: 'DELETE',\n                  url: unlinkUri,\n                  headers\n\n                });\n\n                // UPDATE SMS ACCOUNT BEFORE RE-LINK\n                // this is to ensure the second user gets prompted to OTP\n                var updateUserUrl = config.endpoints.userApi + "/" + user.user_id;\n                await apiCall({\n                    method: 'PATCH',\n                    url: updateUserUrl,\n                    headers,\n                    json: {phone_verified: false}\n                  });\n\n                return apiCall({\n                  method: 'POST',\n                  url: linkUri,\n                  headers,\n                  json: { user_id: smsUserId, provider: "sms" }\n                });\n              }\n            }\n            else {\n                // in this case, a previous link has not occured\n              return apiCall({\n                method: 'POST',\n                url: linkUri,\n                headers,\n                json: { user_id: user.user_id, provider: provider }\n              });\n            }\n          })\n          .then(\n\n            management.updateUser({ id: decodedToken.sub }, userPayload, function (err, user) {\n              if (err) {\n                console.log(LOG_TAG+ '[ERROR]', err);\n                throw err;\n              }\n              context.primaryUser = decodedToken.sub;\n              return _;\n            })\n          ).catch(err => {\n            throw err;\n          });\n      });\n  }\n\n  function continueAuth() {\n    return Promise.resolve();\n  }\n\n  function isVerifiedUser() {\n    if (!user.app_metadata || user.app_metadata.isVerified !== true) {\n      return false;\n    }\n    return true;\n  }\n\n  function promptUser() {\n\n    if (isVerifiedUser()) {\n      return Promise.resolve();\n    }\n\n    return searchUsersWithSamePhone().then(function transformUsers(users) {\n\n      return users.filter(function (u) {\n        return u.user_id !== user.user_id;\n      }).map(function (user) {\n        return {\n          userId: user.user_id,\n          email: user.email,\n          picture: user.picture,\n          connections: user.identities.map(function (identity) {\n            return identity.connection;\n          })\n        };\n      });\n    }).then(function redirectToExtension(targetUsers) {\n      context.redirect = {\n        url: buildRedirectUrl(createToken(config.token), context.request.query)\n      };\n    });\n  }\n\n  function callbackWithSuccess(_) {\n    callback(null, user, context);\n\n    return _;\n  }\n\n  function callbackWithFailure(err) {\n    console.error(LOG_TAG, err.message, err.stack);\n\n    callback(err, user, context);\n  }\n\n  function createToken(tokenInfo, targetUsers) {\n\n    console.log("tokenInfo", tokenInfo);\n    var options = {\n      expiresIn: '5m',\n      audience: tokenInfo.clientId,\n      issuer: qualifyDomain(tokenInfo.issuer)\n    };\n\n    console.log("target users", targetUsers);\n\n    var userSub = {\n      sub: user.user_id,\n      email: user.email,\n      base: auth0.baseUrl,\n      phone_number: user.phone_number\n    };\n\n    return jwt.sign(userSub, tokenInfo.clientSecret, options);\n  }\n\n  function searchUsersWithSamePhone() {\n    var phoneNumberSearch = 'phone_number:"' + user.phone_number + '"';\n    return apiCall({\n      method: 'GET',\n      url: config.endpoints.usersByEmailApi,\n      qs: { q: phoneNumberSearch, search_engine: 'v3' }\n    });\n  }\n\n  // Consider moving this logic out of the rule and into the extension\n  function buildRedirectUrl(token, q, errorType) {\n\n    console.log("Build Redirect URL", q.original_state);\n\n    var params = {\n      child_token: token,\n      audience: q.audience,\n      client_id: q.client_id,\n      redirect_uri: q.redirect_uri,\n      scope: q.scope,\n      response_type: q.response_type,\n      auth0Client: q.auth0Client,\n      original_state: q.original_state || q.state,\n      nonce: q.nonce,\n      error_type: errorType\n    };\n\n    return config.endpoints.linking + '?' + queryString.encode(params);\n  }\n\n  function qualifyDomain(domain) {\n    return 'https://' + domain + '/';\n  }\n\n  function apiCall(options) {\n    return new Promise(function (resolve, reject) {\n      var reqOptions = Object.assign({\n        url: options.url,\n        headers: {\n          Authorization: 'Bearer ' + auth0.accessToken,\n          Accept: 'application/json'\n        },\n        json: true\n      }, options);\n\n      request(reqOptions, function handleResponse(err, response, body) {\n        if (err) {\n          reject(err);\n        } else if (response.statusCode < 200 || response.statusCode >= 300) {\n          console.error(LOG_TAG, 'API call failed: ', body);\n          reject(new Error(body));\n        } else {\n          resolve(response.body);\n        }\n      });\n    });\n  }\n}`}},function(n,e,t){"use strict";var r=t(14)(t(15)),o=t(159).uninstall,i=t(5),a=t(10);n.exports=function(n){return{method:"DELETE",path:"/.extensions/on-uninstall",config:{auth:!1,pre:[n.handlers.validateHookToken("/.extensions/on-uninstall"),n.handlers.managementClient]},handler:function(n,e){a.info("Starting uninstall..."),r.default.all([o(n.pre.auth0.rules),n.pre.auth0.deleteClient({client_id:i("AUTH0_CLIENT_ID")})]).then(function(){return e().code(204)}).catch(function(n){a.error("Something went wrong while uninstalling Account Link Extension: ",n),e().code(204)})}}}},function(n,e,t){"use strict";var r=t(163);n.exports=function(){return{method:"GET",path:"/meta",config:{auth:!1},handler:function(n,e){return e(r)}}}},function(n){n.exports={title:"Auth0 OTP Verification",name:"auth0-otp-verification-extension",version:"1.6.0",preVersion:"1.5.0",author:"nelson.matias",useHashName:!1,description:"This extension gives Auth0 customers the ability verify users phone number using passwordless login",type:"application",logoUrl:"https://cdn.auth0.com/extensions/auth0-authz/assets/logo.svg",docsUrl:"https://auth0.com/docs/extensions/account-link",initialUrlPath:"/login",repository:"https://github.com/nelsonmaia/auth0-otp-verification-extension",keywords:["auth0","extension","account-link"],codeUrl:"https://raw.githubusercontent.com/nelsonmaia/auth0-otp-verification-extension/master/index.js",secrets:{CUSTOM_CSS:{description:"Add custom styles to the linking page of the extension.",required:!1,example:"https://my.cdn.com/my-css.css"}},auth0:{createClient:!0,onUninstallPath:"/.extensions/on-uninstall",onInstallPath:"/.extensions/on-install",onUpdatePath:"/.extensions/on-install",scopes:"read:connections read:users read:rules create:rules update:rules delete:rules delete:clients"}}},function(n,e,t){"use strict";var r=t(165),o=t(5),i=t(143);n.exports=function(){return{method:"GET",path:"/admin",config:{auth:!1},handler:function(n,e){var t=i("production"===o("NODE_ENV"));console.log("is it here somehow"),e(r({stylesheetTag:t.tag("admin"),baseURL:o("PUBLIC_WT_URL")}))}}}},function(n,e,t){"use strict";var r=t(166),o=t(168);n.exports=function(n){var e=n.stylesheetTag,t=n.baseURL;return`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <meta http-equiv="X-UA-Compatible" content="ie=edge">\n    <base href="${t}"/>\n    <title>Auth0 OTP Extension Administrator</title>\n    <link rel="stylesheet" href="https://cdn.auth0.com/styleguide/core/2.0.5/core.min.css" />\n    <link rel="stylesheet" href="https://cdn.auth0.com/styleguide/components/2.0.0/components.min.css" />\n    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/codemirror.min.css">\n    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/theme/material.min.css">\n    ${e}\n</head>\n<body>\n\n${o(t)}\n\n<main class="container app-container">\n    <form action="">\n      <h2>Custom Hosted Page</h2>\n\n      <textarea name="html-code" id="code-editor"></textarea>\n\n      <h2>Widget Settings</h2>\n\n      <div class="alert" id="save-result">\n      </div>\n\n      <div class="form-group">\n        <label for="title">Title</label>\n        <input name="title" class="form-control" id="title_input" />\n      </div>\n\n      <div class="form-group">\n        <label for="logo_path">Logo Path</label>\n        <input name="logo_path" class="form-control" id="logo_path_input"/>\n      </div>\n\n      <div class="form-group">\n        <label for="color">Color</label>\n        <input name="color" class="form-control" id="color_input"/>\n      </div>\n\n      <div class="form-group">\n        <label for="locale">Language</label>\n        <select name="locale" class="form-control" id="available-locales"></select>\n      </div>\n\n      <div class="form-group">\n        <input type="checkbox" id="remove_overlay"/> Remove widget's overlay\n      </div>\n\n      <button class="btn btn-success" id="save-changes">Save changes</button>\n    </form>\n</main>\n\n\n${r}\n</body>\n</html>\n`}},function(n,e,t){"use strict";var r=t(167);n.exports=`\n<script>\nvar JSONStringify = JSON.stringify;\nvar ObjectAssign = Object.assign;\n  \nfunction makeid() {\n    var text = "";\n    var possible = "abcdef0123456789";\n\n    for (var i = 0; i < 6; i++)\n        text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n    return text;\n}\n<\/script>\n<script src="https://code.jquery.com/jquery.min.js"><\/script>\n<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"><\/script>\n<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"><\/script>\n<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/codemirror.min.js"><\/script>\n<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/mode/xml/xml.js"><\/script>\n<script>(${r.toString()})()<\/script>`},function(n,e,t){"use strict";n.exports=function(){var n={},e="",t="Success! Your changes has been successfully saved.",r="Oops! An error has ocurred while trying to save your changes.",o="com.auth0.account_linking.admin_ui.session_token",i=$("base").attr("href"),a=$(".app-container"),s=$(".loading-state-container"),c=$(".avatar"),u=sessionStorage.getItem(o);function l(){window.location.href=i+"/login"}$.ajax({url:i+"/admin/user",headers:{Authorization:"Bearer "+u}}).done(function(n,e){c.attr("src",n.avatar)}).error(function(n){"Unauthorized"===n.statusText&&l()});var f=window.location.pathname;return f.endsWith("/admin")?function(){var n=$("#title_input"),e=$("#logo_path_input"),c=$("#color_input"),f=$("#remove_overlay"),d=$("#available-locales"),p=$("#save-changes"),h=$("#save-result"),v=$("#logout-btn"),m=CodeMirror.fromTextArea(document.getElementById("code-editor"),{lineNumbers:!0,matchBrackets:!0,tabMode:"indent",theme:"material",mode:"xml",htmlMode:!0});function g(n){n?p.addClass("disabled").html("Saving changes..."):p.removeClass("disabled").html("Save changes")}function y(n,e){h.removeClass("alert-danger"),h.removeClass("alert-success"),h.html(n),h.show(),e&&e.error?h.addClass("alert-danger"):h.addClass("alert-success"),setTimeout(function(){h.html(""),h.hide(),e.error?h.removeClass("alert-danger"):h.removeClass("alert-success")},1e4)}u||l(),m.setSize(null,500),$.ajax({url:i+"/admin/settings",headers:{Authorization:"Bearer "+u}}).done(function(t){s.hide(),a.show(),function(n,e){n.setValue(e.template.trim())}(m,t),function(n){n.availableLocales.forEach(function(e){var t=n.locale===e.code?"selected":"";d.append(`<option value="${e.code}" ${t}>${e.name}</option>`)})}(t),n.val(t.title),c.val(t.color),e.val(t.logoPath),f.prop("checked",t.removeOverlay||!1)}).error(function(n){"Unauthorized"===n.statusText&&l()}),p.on("click",function(o){o.preventDefault(),g(!0),$.ajax({url:i+"/admin/settings",method:"PUT",data:{template:m.getValue(),locale:d.val(),logoPath:e.val(),color:c.val(),title:n.val(),removeOverlay:f.is(":checked")},headers:{Authorization:"Bearer "+u}}).done(function(n,e){y("<h4>"+t+"</h4>"),g(!1)}).error(function(n){void 0!==n.responseJSON.message?y("<h4>"+r+"</h4> <p>"+n.responseJSON.message+"</p>",{error:!0}):y("<h4>"+r+"</h4>",{error:!0}),g(!1)})}),v.on("click",function(){sessionStorage.removeItem(o),window.location.reload()}),$(window).bind("keydown",function(n){if(n.ctrlKey||n.metaKey)switch(String.fromCharCode(n.which).toLowerCase()){case"s":n.preventDefault(),p.click()}})}():f.endsWith("/admin/locale")?function(){var t=$("#locale-menu"),r=($("#locale-detail"),$("#locale-title")),o=$("#locale-management-table"),c=$("#locale-management-submit"),l=$("#add-new-locale"),f=$("#add-new-locale-name"),d=$("#add-new-locale-code"),p=$("#help-button"),h=$("#help-button-content");function v(){$.ajax({url:i+"/admin/locales",method:"PUT",contentType:"application/json",data:JSONStringify(n),processData:!1,headers:{Authorization:"Bearer "+u}}).done(function(n,e){toastr.success("You have successfully saved your locales.","Success!")}).error(function(n){void 0!==n.responseJSON.message?toastr.error(n.responseJSON.message,"Error"):toastr.error("Please try again later.","Error")})}function m(){for(var i in t.find("li").remove(),n)t.append(`<li class="list-group-item" data-locale-name="${i}">${n[i]._name}</li>`);$(".list-group-item").on("click",function(){$(this).addClass("active"),$(this).siblings().removeClass("active"),e=$(this).attr("data-locale-name"),function(){var t=n[e];for(var i in $("tr:not(tr.header)").remove(),r.html(t._name),t)"_name"!==i&&o.append('<tr><td id="key">'+i+'</td><td><input class="form-control" value="'+t[i]+'" /></td>')}()}),$("#locale-menu li")[0].click()}p.on("mouseover",function(){h.show(),h.animate({opacity:1,top:"-=20"},300)}),p.on("mouseleave",function(){setTimeout(function(){h.animate({opacity:0,top:"+=20"},300,function(){return h.hide()})},300)}),$.ajax({url:i+"/admin/locales",method:"GET",headers:{Authorization:"Bearer "+u}}).done(function(e,t){s.hide(),a.show(),n=e,m()}).error(function(n){s.hide(),alert(n)}),c.on("click",function(){var t={_name:n[e]._name};o.find("tr").each(function(){var n=$(this).find("#key").html(),e=$(this).find("input").val();t[n]=e}),n[e]=t,v()}),l.on("click",function(e){e.preventDefault();var t=d.val(),r=f.val();n[t]=ObjectAssign({},n.en,{_name:`${r} (Custom)`}),m(),f.val(""),d.val("")}),$("#remove-locale-btn").on("click",function(t){t.preventDefault(),confirm("Are you sure?")&&(delete n[e],m(),v())})}():void 0}},function(n,e,t){"use strict";n.exports=function(n){return`\n<header class="site-header">\n <nav class="navbar navbar-default" role="navigation">\n    <div class="container">\n      <div class="navbar-header">\n        <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-collapse"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>\n        </button>\n        <span>\n            <h1 class="navbar-brand"><a href="${n}/admin"><span>Auth0</span> <div class="product-name">Account Linking Extension</div></a></h1>\n        </span>\n      </div>\n      <div class="collapse navbar-collapse" id="navbar-collapse">\n        <ul class="nav navbar-nav navbar-left no-basic">\n        </ul>\n        <ul class="nav navbar-nav navbar-right">\n          <li class="dropdown"><span class="btn-dro" role="button" data-toggle="dropdown">\n            <img src="" alt="" class="avatar">\n            <i class="icon-budicon-460"></i></span>\n            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">\n              <li><a href="${n}/admin/locale" target="_blank">Manage locales</a></li>\n              <li><a href="https://github.com/auth0-extensions/auth0-account-link-extension/issues/new" target="_blank">Report an issue</a></li>\n              <li class="separator"></li>\n              <li><a href="#" id="logout-btn">Logout</a>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </nav>\n</header>\n\n<section class="loading-state-container">\n  <div class="spinner spinner-lg is-auth0">\n    <div class="circle"></div>\n  </div>\n</section>`}},function(n,e,t){"use strict";var r=t(170),o=t(5),i=t(143);n.exports=function(){return{method:"GET",path:"/admin/locale",config:{auth:!1},handler:function(n,e){var t=i("production"===o("NODE_ENV"));e(r({stylesheetTag:t.tag("admin"),baseURL:o("PUBLIC_WT_URL")}))}}}},function(n,e,t){"use strict";var r=t(166),o=t(168);n.exports=function(n){var e=n.stylesheetTag,t=n.baseURL;return`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <meta http-equiv="X-UA-Compatible" content="ie=edge">\n    <base href="${t}"/>\n    <title>Auth0 OTP Extension Administrator</title>\n    <link rel="stylesheet" href="https://cdn.auth0.com/styleguide/core/2.0.5/core.min.css" />\n    <link rel="stylesheet" href="https://cdn.auth0.com/styleguide/components/2.0.0/components.min.css" />\n    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/codemirror.min.css">\n    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.31.0/theme/material.min.css">\n    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />\n    ${e}\n</head>\n<body>\n\n${o(t)}\n\n<main class="container app-container">\n    <div class="row">\n        <div class="col-sm-4">\n            <div class=" list-group" id="locale-menu">\n            </div>\n            <div>\n                <h4>Add new locale \n    <span id="help-button">?</span>\n    <div class="help-container">\n        <div id="help-button-content">\n            <h5>Adding a new locale</h5>\n            <p>You can add custom locales for your users to use. You will need to specify the following data:</p>\n            <ul>\n                <li><strong>ISO Code</strong>: ISO 639-1 Complaint Locale Code. i.e.: es, en, pt.</li>\n                <li><strong>Name</strong>: A friendly name for the locale. i.e.: Spanish, English, Portuguese.</li>\n            </ul>\n        </div>\n    </div>\n</h4>\n                <div class="input-group">\n                    <input id="add-new-locale-code" class="add-new-locale-input form-control" placeholder="Code" />\n                    <input id="add-new-locale-name" class="add-new-locale-input form-control" placeholder="Name" />\n                    <span class="input-group-btn">\n                        <button id="add-new-locale" class="btn btn-primary" type="button">Add</button>\n                    </span>\n                </div>\n            </div>\n        </div>\n        \n        \n        <div class="col-sm-8" id="locale-detail">\n            <h2 id="locale-title"></h2>\n\n            <table id="locale-management-table" class="table table-striped">\n                    <th class="header" width="20%">Name</th>\n                    <th class="header" width="80%">Message</th>\n            </table>\n\n            <button id="locale-management-submit" class="btn btn-primary">Save changes</button>\n            \n            <hr/>\n            \n            <div class="panel panel-danger">\n                <div class="panel-heading">Remove locale</div>\n                <div class="panel-body">\n                    <p>Once removed, you cannot undo this change.</p>\n                    <a class="btn btn-danger" id="remove-locale-btn">Remove locale</a>\n                </div>\n            </p>\n        </div>\n    </div>\n</main>\n\n\n${r}\n</body>\n</html>\n`}},function(n,e,t){"use strict";var r=t(137).getLocales;n.exports=function(){return{method:"GET",config:{auth:"jwt"},path:"/admin/locales",handler:function(n,e){return r().then(e)}}}},function(n,e,t){"use strict";var r=t(137).setLocales;n.exports=function(){return{method:"PUT",config:{auth:"jwt"},path:"/admin/locales",handler:function(n,e){return r(n.payload).then(e)}}}},function(n,e,t){"use strict";var r=t(14),o=r(t(174)),i=r(t(88)),a=r(t(106)),s=r(t(177)),c=t(137),u=c.getSettings,l=c.getLocales;n.exports=function(){return{method:"GET",config:{auth:"jwt"},path:"/admin/settings",handler:(n=(0,s.default)(o.default.mark(function n(e,t){var r,s;return o.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l();case 2:r=n.sent,s=(0,a.default)(r).map(function(n){return{code:n,name:r[n]._name}}),u().then(function(n){t((0,i.default)({},n,{availableLocales:s}))});case 5:case"end":return n.stop()}},n,this)})),function(e,t){return n.apply(this,arguments)})};var n}},function(n,e,t){n.exports=t(175)},function(n,e,t){var r=function(){return this}()||Function("return this")(),o=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,i=o&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,n.exports=t(176),o)r.regeneratorRuntime=i;else try{delete r.regeneratorRuntime}catch(n){r.regeneratorRuntime=void 0}},function(n,e){!function(e){"use strict";var t,r=Object.prototype,o=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag",u="object"==typeof n,l=e.regeneratorRuntime;if(l)u&&(n.exports=l);else{(l=e.regeneratorRuntime=u?n.exports:{}).wrap=x;var f="suspendedStart",d="suspendedYield",p="executing",h="completed",v={},m={};m[a]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(A([])));y&&y!==r&&o.call(y,a)&&(m=y);var b=L.prototype=_.prototype=Object.create(m);k.prototype=b.constructor=L,L.constructor=k,L[c]=k.displayName="GeneratorFunction",l.isGeneratorFunction=function(n){var e="function"==typeof n&&n.constructor;return!!e&&(e===k||"GeneratorFunction"===(e.displayName||e.name))},l.mark=function(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,L):(n.__proto__=L,c in n||(n[c]="GeneratorFunction")),n.prototype=Object.create(b),n},l.awrap=function(n){return{__await:n}},S(T.prototype),T.prototype[s]=function(){return this},l.AsyncIterator=T,l.async=function(n,e,t,r){var o=new T(x(n,e,t,r));return l.isGeneratorFunction(e)?o:o.next().then(function(n){return n.done?n.value:o.next()})},S(b),b[c]="Generator",b[a]=function(){return this},b.toString=function(){return"[object Generator]"},l.keys=function(n){var e=[];for(var t in n)e.push(t);return e.reverse(),function t(){for(;e.length;){var r=e.pop();if(r in n)return t.value=r,t.done=!1,t}return t.done=!0,t}},l.values=A,E.prototype={constructor:E,reset:function(n){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!n)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=t)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function r(r,o){return s.type="throw",s.arg=n,e.next=r,o&&(e.method="next",e.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(n,e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===n||"continue"===n)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=n,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(n,e){if("throw"===n.type)throw n.arg;return"break"===n.type||"continue"===n.type?this.next=n.arg:"return"===n.type?(this.rval=this.arg=n.arg,this.method="return",this.next="end"):"normal"===n.type&&e&&(this.next=e),v},finish:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.finallyLoc===n)return this.complete(t.completion,t.afterLoc),O(t),v}},catch:function(n){for(var e=this.tryEntries.length-1;e>=0;--e){var t=this.tryEntries[e];if(t.tryLoc===n){var r=t.completion;if("throw"===r.type){var o=r.arg;O(t)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(n,e,r){return this.delegate={iterator:A(n),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=t),v}}}function x(n,e,t,r){var o=e&&e.prototype instanceof _?e:_,i=Object.create(o.prototype),a=new E(r||[]);return i._invoke=function(n,e,t){var r=f;return function(o,i){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return P()}for(t.method=o,t.arg=i;;){var a=t.delegate;if(a){var s=j(a,t);if(s){if(s===v)continue;return s}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if(r===f)throw r=h,t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);r=p;var c=w(n,e,t);if("normal"===c.type){if(r=t.done?h:d,c.arg===v)continue;return{value:c.arg,done:t.done}}"throw"===c.type&&(r=h,t.method="throw",t.arg=c.arg)}}}(n,t,a),i}function w(n,e,t){try{return{type:"normal",arg:n.call(e,t)}}catch(n){return{type:"throw",arg:n}}}function _(){}function k(){}function L(){}function S(n){["next","throw","return"].forEach(function(e){n[e]=function(n){return this._invoke(e,n)}})}function T(n){var e;this._invoke=function(t,r){function i(){return new Promise(function(e,i){!function e(t,r,i,a){var s=w(n[t],n,r);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&o.call(u,"__await")?Promise.resolve(u.__await).then(function(n){e("next",n,i,a)},function(n){e("throw",n,i,a)}):Promise.resolve(u).then(function(n){c.value=n,i(c)},a)}a(s.arg)}(t,r,e,i)})}return e=e?e.then(i,i):i()}}function j(n,e){var r=n.iterator[e.method];if(r===t){if(e.delegate=null,"throw"===e.method){if(n.iterator.return&&(e.method="return",e.arg=t,j(n,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var o=w(r,n.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,v;var i=o.arg;return i?i.done?(e[n.resultName]=i.value,e.next=n.nextLoc,"return"!==e.method&&(e.method="next",e.arg=t),e.delegate=null,v):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function C(n){var e={tryLoc:n[0]};1 in n&&(e.catchLoc=n[1]),2 in n&&(e.finallyLoc=n[2],e.afterLoc=n[3]),this.tryEntries.push(e)}function O(n){var e=n.completion||{};e.type="normal",delete e.arg,n.completion=e}function E(n){this.tryEntries=[{tryLoc:"root"}],n.forEach(C,this),this.reset(!0)}function A(n){if(n){var e=n[a];if(e)return e.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var r=-1,i=function e(){for(;++r<n.length;)if(o.call(n,r))return e.value=n[r],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:t,done:!0}}}(function(){return this}()||Function("return this")())},function(n,e,t){var r=t(15);n.exports=function(n){return function(){var e=this,t=arguments;return new r(function(o,i){var a=n.apply(e,t);function s(n,e){try{var t=a[n](e),s=t.value}catch(n){return void i(n)}t.done?o(s):r.resolve(s).then(c,u)}function c(n){s("next",n)}function u(n){s("throw",n)}c()})}}},function(n,e,t){"use strict";var r=t(179),o=t(137).setSettings,i=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/,a=/^#[A-Fa-f0-9]{6}/;n.exports=function(){return{method:"PUT",config:{auth:"jwt",validate:{payload:{template:r.string().required(),locale:r.string().required(),title:r.string().required(),color:r.string().regex(a).required(),logoPath:r.string().regex(i).allow(""),removeOverlay:r.bool().default(!1)}}},path:"/admin/settings",handler:function(n,e){o(n.payload).then(function(n){e(n)})}}}},function(n,e){n.exports=require("joi@9.0.4")},function(n,e,t){"use strict";var r=t(181);n.exports=function(){return{method:"GET",path:"/admin/user",config:{auth:"jwt"},handler:function(n,e){e({email:n.auth.credentials.email,avatar:r(n.auth.credentials.email)})}}}},function(n,e,t){"use strict";var r=t(182);n.exports=function(n){return`https://s.gravatar.com/avatar/${r.createHash("md5").update(n).digest("hex")}?s=480&r=pg&d=https%3A%2F%2Fcdn.auth0.com%2Favatars%2F${n.substr(0,2)}.png`}},function(n,e){n.exports=require("crypto")},function(n,e,t){"use strict";var r=t(1).handlers,o=t(5),i=t(10),a=function(n,e,t){n.decorate("server","handlers",{managementClient:r.managementApiClient({domain:o("AUTH0_DOMAIN"),clientId:o("AUTH0_CLIENT_ID"),clientSecret:o("AUTH0_CLIENT_SECRET"),logger:i.error}),validateHookToken:r.validateHookToken(o("AUTH0_DOMAIN"),o("WT_URL"),o("EXTENSION_SECRET"))}),console.log("Handler finished"),t()};a.attributes={name:"handlers"},n.exports=a},function(n,e,t){"use strict";var r=t(185),o=t(186),i=t(85),a=t(1),s=t(5),c=[{value:"openid"},{value:"profile"}];n.exports.register=function(n,e,t){var u={dashboardAdmin:{key:s("EXTENSION_SECRET"),verifyOptions:{audience:"urn:api-account-linking",issuer:s("PUBLIC_WT_URL"),algorithms:["HS256"]}},resourceServer:{key:o.hapiJwt2Key({cache:!0,rateLimit:!0,jwksRequestsPerMinute:2,jwksUri:`https://${s("AUTH0_DOMAIN")}/.well-known/jwks.json`}),verifyOptions:{audience:"urn:auth0-account-linking-api",issuer:`https://${s("AUTH0_DOMAIN")}/`,algorithms:["RS256"]}}};n.auth.strategy("jwt","jwt",{complete:!0,verifyFunc:function(n,e,t){if(console.log("header is",o),!n)return t(null,!1);var o=e.headers.authorization;if(o&&0===o.indexOf("Bearer ")){var a=o.split(" ")[1];if(n&&n.payload&&n.payload.iss===`https://${s("AUTH0_DOMAIN")}/`)return u.resourceServer.key(n,function(e,o){return e?t(r.wrap(e),null,null):i.verify(a,o,u.resourceServer.verifyOptions,function(e){return e?t(r.unauthorized("Invalid token","Token"),null,null):n.payload.gty&&"client-credentials"!==n.payload.gty?t(r.unauthorized("Invalid token","Token"),null,null):n.payload.sub.endsWith("@clients")?(n.payload.scope&&"string"==typeof n.payload.scope&&(n.payload.scope=n.payload.scope.split(" ")),t(null,!0,n.payload)):t(r.unauthorized("Invalid token","Token"),null,null)})});if(n&&n.payload&&n.payload.iss===s("PUBLIC_WT_URL"))return i.verify(a,u.dashboardAdmin.key,u.dashboardAdmin.verifyOptions,function(e){return e?t(r.unauthorized("Invalid token","Token"),null,null):n.payload.access_token&&n.payload.access_token.length?(n.payload.scope=c.map(function(n){return n.value}),t(null,!0,n.payload)):t(r.unauthorized("Invalid token","Token"),null,null)})}return t(null,!1)}}),n.auth.default("jwt");var l={register:a.plugins.dashboardAdminSession,options:{stateKey:"account-linking-admin-state",sessionStorageKey:"com.auth0.account_linking.admin_ui.session_token",rta:s("AUTH0_RTA").replace("https://",""),domain:s("AUTH0_DOMAIN"),scopes:"",baseUrl:s("PUBLIC_WT_URL"),audience:"urn:api-account-linking",secret:s("EXTENSION_SECRET"),clientName:"auth0-account-link",onLoginSuccess:function(n,e,t){return n?(n.scope=c.map(function(n){return n.value}),t(null,!0,n)):t(null,!1)}}};n.register(l,function(n){n&&t(n),t()})},n.exports.register.attributes={name:"auth"}},function(n,e){n.exports=require("boom@3.2.2")},function(n,e){n.exports=require("jwks-rsa@1.1.1")}]);